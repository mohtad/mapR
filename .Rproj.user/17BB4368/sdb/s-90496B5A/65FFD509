{
    "collab_server" : "",
    "contents" : "#\n#Pull data from Teradata\n#\ndrv = JDBC(\"com.teradata.jdbc.TeraDriver\",\"C:\\\\dev\\\\apache-tomcat-7.0.56\\\\lib\\\\terajdbc4.jar;C:\\\\dev\\\\apache-tomcat-7.0.56\\\\lib\\\\tdgssconfig.jar\")\nconn = dbConnect(drv,\"jdbc:teradata://tdprd.dw.bizsys.tmcs\",\"mnadjar\",\"mnadjar\")\ndata =dbGetQuery(conn,\"SELECT\n                            report,\n                            postal_code as zipcode,\n                            cust_2016_all,   \t     -- 2016 Singles - All\n                            cust_2016_new,   \t-- 2016 Singles - New Customers\n                            cust_2016_returning,  --- 2016 Singles - Returning Customers\n                            cust_2016_reactivated   --- 2016 Singles - Reactivated Customers\n                            FROM plasb.kc_2016_zip_report\n                            ;\n                            \")\n# the location of the venue\nlocations = data.frame(name=c(\"Children's Mercy Park\", \"toto\", \"toto2\", \"toto3\"), long = c(-94.823686, -94.823686, -94.823686, -94.823686), lat = c(39.121296,39.121296,39.121296,39.121296) )\n# project in mercator axis system\n#locations$mer_long = mercator(c(locations$long,locations$lat))[1]\n#locations$mer_lat = mercator(c(locations$long,locations$lat))[2]\n\n#\nmap_center = data.frame(long = c(-94.823686), lat = c(39.121296) )\n#\n#Compute zip 'distance to' venue\n#\ndata$bin <- add_bins(data,\"cust_2016_all\", br = c(-1,0,1,5,12,50,198), lab=c(\"0\",\"1\",\"2 to 5\",\"6 to 12\",\"13 to 50\",\"51 to 198\"))\n\nshape_us_zcta_dir = \"C:/Users/Mohtadi.Nadjar/heatmapR/Template/shape/zcta/us/cb_2015_us_zcta510_500k\"\nshape_us_zcta_filename = \"cb_2015_us_zcta510_500k\"\nShape_US_Roads_dir = \"C:/Users/Mohtadi.Nadjar/heatmapR/Template/shape/roads/us/tl_2016_us_primaryroads\"\nShape_US_Roads_filename = \"tl_2016_us_primaryroads\"\nus_zcta_path = \"C:/Users/Mohtadi.Nadjar/heatmapR/Template/zcta_coordinates/2015_Gaz_zcta_national.txt\"\n\nshape_zcta<-load_shape_us_zcta(shape_us_zcta_dir, shape_us_zcta_filename)\nshape_roads<-load_shape_us_roads(Shape_US_Roads_dir, Shape_US_Roads_filename)\nzcta<-load_us_zcta(us_zcta_path, map_center)\n\n\ndist_center<-25\nlegend_title<-'All Singles'\nzoom<-10\ncolor_bins<-c(\"#ececec\",\"#fcc5c0\",\"#fa9fb5\",\"#f768a1\",\"#c51b8a\",\"#7a0177\")\np<-create_map(data, shape_zcta, shape_roads,zcta, map_center,  dist_center, locations, legend_title, zoom, color_bins, FALSE)\np\n\ndevtools::load_all()\ndevtools::install()\n\n",
    "created" : 1482304007995.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1828744340",
    "id" : "65FFD509",
    "lastKnownWriteTime" : 1483757465,
    "last_content_update" : 1483757465761,
    "path" : "~/heatmapR/Template_heatmapR_step2_20161205.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : true,
    "source_window" : "",
    "type" : "r_source"
}